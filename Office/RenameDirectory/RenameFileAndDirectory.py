#!/usr/bin/python3
"""
文件/文件夹批量重命名脚本
================================
功能：
  - 根据规则文件，对指定目录下的文件或文件夹进行批量改名
  - 支持精确匹配 / 模糊匹配 / 替换部分字符 等多种模式
  - 可设置仅针对文件或文件夹，或两者同时处理
  - 可设置是否包含隐藏文件、排除指定目录/文件

使用方法：
  1. 编写规则文件（默认 1.txt），格式为：
       查找字符串<TAB>替换字符串<TAB>模式编号
     例如：
       oldname    newname    1
     模式编号说明：
       1 = 精确匹配整个文件名/目录名
       2 = 模糊匹配（包含即可）
       3 = 部分替换（只替换文件名中出现的目标子串）

  2. 修改脚本参数（脚本顶部）：
       - rulesFile: 规则文件名（默认 "1.txt"）
       - MatchMode: 匹配模式（0=按规则文件中指定，1=精确，2=模糊，3=替换）
       - MatchObj : 针对对象（0=文件+文件夹，1=文件，2=文件夹）
       - encludeHinddenFile: 是否包含隐藏文件 True/False
       - exclude: 排除的文件/文件夹列表
       - exclude_str: 排除包含指定字符串的文件/文件夹

  3. 在目标目录运行脚本，例如：
       python3 rename.py
     （脚本默认处理当前目录及子目录）

  4. 查看打印输出确认结果，已重命名的文件会显示：
       重命名 oldpath -> newpath

注意事项：
  - 建议先在测试目录运行，避免误改名
  - 规则文件里的制表符必须是真正的 <TAB>
  - 如果 MatchMode=0，则使用规则文件中第三列的模式编号；
    如果 MatchMode=1/2/3，则全局统一用该模式

依赖：
  - 自定义模块 m_System（需与本脚本在同目录）
"""

import os.path
import m_System

# 规则文件
rulesFile = "1.txt"
# 匹配模式：0=根据规则文件中的来，1=精确匹配，2=模糊匹配，3=替换字符
MatchMode = 2
# 针对对象：0=all 1=file 2=dir
MatchObj = 0
# 是否包含隐藏文件
encludeHinddenFile = True

# 排除的目录和文件
exclude = ["__pycache__"]
# 排除包含某些字符串的文件、文件夹
exclude_str = None

...

